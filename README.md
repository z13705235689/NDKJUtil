# NDKJ_MES - 制造执行系统

## 项目简介

NDKJ_MES是一个基于Python和PySide6开发的制造执行系统（Manufacturing Execution System），专为制造业企业设计，提供完整的生产管理解决方案。

## 主要功能

### 📦 物料管理
- **物料基础信息管理**：支持物料编码、名称、规格、品牌等信息的维护
- **物料类型分类**：原材料(RM)、半成品(SFG)、成品(FG)、包装材料(PKG)
- **物料导入功能**：支持Excel文件批量导入物料信息
- **物料搜索功能**：支持编码、名称、规格的模糊搜索

### 🏭 BOM管理
- **BOM结构管理**：支持多层级BOM结构的创建和维护
- **BOM展开功能**：自动计算生产所需的所有原材料和组件
- **BOM搜索功能**：快速定位使用特定组件的BOM结构
- **BOM导入功能**：支持Excel文件批量导入BOM数据

### 📊 库存管理
- **库存余额管理**：实时显示各仓库的物料库存情况
- **库存流水记录**：详细记录所有库存操作历史
- **库存导入功能**：支持Excel文件批量更新库存
- **库存预警**：低于安全库存的物料自动高亮显示
- **库存导出功能**：支持库存数据的导出

### 📋 客户订单管理
- **订单信息管理**：客户订单的录入和维护
- **订单解析功能**：自动解析订单文件，提取订单明细
- **订单状态跟踪**：实时跟踪订单执行状态

### 📈 MRP计算
- **物料需求计划**：基于客户订单自动计算物料需求
- **BOM展开计算**：考虑损耗率的精确需求计算
- **库存平衡计算**：考虑现有库存的净需求计算
- **MRP看板**：直观显示物料需求计划结果
- **实时搜索**：支持MRP结果的实时搜索和筛选

### 🗄️ 数据库管理
- **数据库初始化**：自动创建和初始化数据库结构
- **数据备份恢复**：支持数据库的备份和恢复功能
- **数据导入导出**：支持各种格式的数据导入导出

## 技术架构

### 开发环境
- **Python 3.10+**
- **PySide6** - GUI框架
- **SQLite** - 数据库
- **pandas** - 数据处理

### 项目结构
```
NDKJ_MES/
├── app/
│   ├── ui/                    # 用户界面模块
│   │   ├── ui_main.py        # 主界面
│   │   ├── materia_management.py      # 物料管理
│   │   ├── bom_management.py          # BOM管理
│   │   ├── inventory_management.py   # 库存管理
│   │   ├── customer_order_management.py # 客户订单管理
│   │   ├── mrp_viewer.py             # MRP看板
│   │   └── database_management.py     # 数据库管理
│   ├── services/             # 业务逻辑模块
│   │   ├── item_service.py           # 物料服务
│   │   ├── bom_service.py            # BOM服务
│   │   ├── inventory_service.py     # 库存服务
│   │   ├── mrp_service.py           # MRP计算服务
│   │   ├── customer_order_service.py # 客户订单服务
│   │   └── warehouse_service.py     # 仓库服务
│   ├── db.py                 # 数据库连接
│   └── schema.sql            # 数据库结构
├── build_exe.py             # 打包脚本
└── README.md                # 项目说明
```

## 安装和运行

### 环境要求
- Python 3.10 或更高版本
- Windows 10/11

### 安装步骤

1. **克隆项目**
   ```bash
   git clone [项目地址]
   cd NDKJ_MES
   ```

2. **创建虚拟环境（推荐）**
   ```bash
   python -m venv myenv
   myenv\Scripts\activate
   ```

3. **安装依赖**
   ```bash
   pip install PySide6 pandas
   ```

4. **运行程序**
   ```bash
   python app/ui/ui_main.py
   ```

### 打包为可执行文件

使用提供的打包脚本：
```bash
python build_exe.py
```

打包完成后，可执行文件将生成在 `release/` 目录中。

## 使用指南

### 首次使用

1. **启动系统**：运行主程序
2. **初始化数据库**：系统会自动创建数据库结构
3. **基础数据录入**：
   - 录入物料基础信息
   - 创建仓库信息
   - 建立BOM结构

### 日常操作流程

#### 物料管理
1. 进入"物料管理"页面
2. 使用"导入"功能批量导入物料信息
3. 使用搜索功能快速定位物料

#### BOM管理
1. 进入"BOM管理"页面
2. 创建新的BOM结构
3. 添加BOM明细
4. 使用"BOM展开"功能计算物料需求

#### 库存管理
1. 进入"库存管理"页面
2. 使用"库存导入"功能更新库存
3. 查看库存余额和流水记录
4. 导出库存报表

#### MRP计算
1. 进入"MRP看板"页面
2. 选择客户订单版本
3. 设置计算参数
4. 查看计算结果

## 功能特色

### 🔍 智能搜索
- 支持多字段模糊搜索
- 实时搜索结果更新
- 支持编码、名称、规格的联合搜索

### 📊 数据可视化
- 直观的表格显示
- 颜色标识重要信息
- 支持数据排序和筛选

### 🔄 批量操作
- Excel文件批量导入
- 支持多种数据格式
- 自动数据验证和错误提示

### 📈 实时计算
- MRP实时计算
- 库存实时更新
- 需求实时统计

### 🛡️ 数据安全
- 数据库自动备份
- 操作日志记录
- 数据完整性检查

## 数据格式说明

### 物料导入格式
Excel文件应包含以下列：
- 物料代码
- 物料名称
- 物料规格（可选）
- 商品品牌
- 基本单位
- 物料类型

### 库存导入格式
Excel文件应包含以下列：
- 物料代码
- 规格型号（可选）
- 基本单位数量

### BOM导入格式
Excel文件应包含以下列：
- 父物料代码
- 子物料代码
- 用量
- 损耗率

## 常见问题

### Q: 系统启动失败怎么办？
A: 检查Python版本是否为3.10+，确保已安装PySide6和pandas。

### Q: 数据库文件损坏怎么办？
A: 删除mes.db文件，重新启动系统会自动创建新的数据库。

### Q: 导入Excel文件失败怎么办？
A: 检查Excel文件格式是否符合要求，确保列名正确。

### Q: MRP计算结果为空怎么办？
A: 检查客户订单数据是否正确，确保BOM结构完整。

## 更新日志

### v1.0.0 (2024-12-19)
- 初始版本发布
- 实现基础物料管理功能
- 实现BOM管理功能
- 实现库存管理功能
- 实现MRP计算功能
- 实现客户订单管理功能

## 技术支持

如有问题或建议，请联系开发团队。

## 许可证

本项目采用MIT许可证。

---

**NDKJ_MES** - 让制造管理更简单、更高效！
